<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>app/Main.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##1227 : GHC.Types.Module | $k_##1228}</span><span class='hs-keyword'>{-@</span></a> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Main</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.List</span>
<span class=hs-linenum>  5: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>S</span>
<span class=hs-linenum>  6: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>System.IO</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>--Types to be used :</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>--type Literal = Int</span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>--type Clause = [Literal]</span>
<span class=hs-linenum> 11: </span><span class='hs-comment'>--type Formula = [Clause]</span>
<span class=hs-linenum> 12: </span><span class='hs-comment'>--type Model = [Int]</span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>--data Result = SAT Modell, UNSAT</span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>--type Clause ; vec (GADTS)  list (LH)</span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>--type formula; vac (GADTS) list (LH)</span>
<span class=hs-linenum> 16: </span><span class='hs-comment'>--data lit = lit = polarity = nat (number greater than or equal to 1)</span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>--data Polarity = Pos / Neg</span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>--Nat type = (LH) int with refinement; Peano numbers (GADTS)</span>
<span class=hs-linenum> 19: </span><span class='hs-comment'>--type Clause = [lits]</span>
<span class=hs-linenum> 20: </span>
<span class=hs-linenum> 21: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Literal</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Clause</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Literal</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Clause</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 24: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Model</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 25: </span>
<span class=hs-linenum> 26: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>litsC</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 27: </span><span class='hs-comment'>-- to get set of all literals in a clause</span>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-definition'>litsC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Clause</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S.Set</span> <span class='hs-conid'>Literal</span>
<span class=hs-linenum> 30: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1256:[GHC.Types.Int] -&gt; {VV : (Data.Set.Internal.Set GHC.Types.Int) | VV == Main.litsC lq_tmp$x##1256}</span><span class='hs-definition'>litsC</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a4Ar .
      {lq_tmp$x##1283 : (Data.Set.Internal.Set a##a4Ar) | Set_emp lq_tmp$x##1283} | VV == Data.Set.Internal.empty}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum> 31: </span><span class='hs-definition'>litsC</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-conop'>:</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1328 : (Data.Set.Internal.Set GHC.Types.Int) | lq_tmp$x##1328 == Main.litsC cs##a1Y3}</span><span class='hs-varid'>litsC</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1336 : [GHC.Types.Int] | lq_tmp$x##1336 == cs##a1Y3
                                    &amp;&amp; len lq_tmp$x##1336 &gt;= 0}</span><span class='hs-varid'>cs</span></a> <span class='hs-varop'>`S.union`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1341 : (Data.Set.Internal.Set {lq_tmp$x##1346 : GHC.Types.Int | $k_##1345[VV##1344:=lq_tmp$x##1346][lq_tmp$x##1343:=l##a1Y2]}) | lq_tmp$x##1341 == Set_sng l##a1Y2}</span><span class='hs-conid'>S.singleton</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1347 : GHC.Types.Int | lq_tmp$x##1347 == l##a1Y2}</span><span class='hs-varid'>l</span></a>
<span class=hs-linenum> 32: </span><span class='hs-comment'>-- S.union (litsC cs) (singleton l)</span>
<span class=hs-linenum> 33: </span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>litsF</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 36: </span><span class='hs-comment'>-- define a litsF which takes a formula and gives a set of literals</span>
<span class=hs-linenum> 37: </span><span class='hs-definition'>litsF</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S.Set</span> <span class='hs-conid'>Literal</span>
<span class=hs-linenum> 38: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1375:[[GHC.Types.Int]] -&gt; {VV : (Data.Set.Internal.Set GHC.Types.Int) | VV == Main.litsF lq_tmp$x##1375}</span><span class='hs-definition'>litsF</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a4Ar .
      {lq_tmp$x##1420 : (Data.Set.Internal.Set a##a4Ar) | Set_emp lq_tmp$x##1420} | VV == Data.Set.Internal.empty}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum> 39: </span><span class='hs-definition'>litsF</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ls</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1479 : (Data.Set.Internal.Set GHC.Types.Int) | lq_tmp$x##1479 == Main.litsF ls##a1Y5}</span><span class='hs-varid'>litsF</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1497 : [[GHC.Types.Int]] | lq_tmp$x##1497 == ls##a1Y5
                                      &amp;&amp; len lq_tmp$x##1497 &gt;= 0}</span><span class='hs-varid'>ls</span></a> <span class='hs-varop'>`S.union`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1507 : (Data.Set.Internal.Set GHC.Types.Int) | lq_tmp$x##1507 == Main.litsC c##a1Y4}</span><span class='hs-varid'>litsC</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1515 : [GHC.Types.Int] | lq_tmp$x##1515 == c##a1Y4
                                    &amp;&amp; len lq_tmp$x##1515 &gt;= 0}</span><span class='hs-varid'>c</span></a>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span>
<span class=hs-linenum> 42: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 43: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##1566 : () | $k_##1565[VV##1564:=lq_tmp$x##1566][lq_tmp$x##1563:=Main.main]})</span><span class='hs-definition'>main</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1556 : () | lq_tmp$x##1556 == GHC.Tuple.()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum> 44: </span>
<span class=hs-linenum> 45: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>solveSAT</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{f:</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Model</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 46: </span><span class='hs-definition'>solveSAT</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Model</span>
<span class=hs-linenum> 47: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##4652:[[GHC.Types.Int]] -&gt; (GHC.Maybe.Maybe [GHC.Types.Int])</span><span class='hs-definition'>solveSAT</span></a> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-varid'>formula</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getModel</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4712 : [[GHC.Types.Int]] | lq_tmp$x##4712 == formula##a1Y6
                                      &amp;&amp; len lq_tmp$x##4712 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##4661 : [a]&lt;\lq_tmp$x##4662 VV -&gt; {lq_tmp$x##4660 : a&lt;p lq_tmp$x##4662&gt; | true}&gt; | Set_emp (listElts lq_tmp$x##4661)
                                                                                                   &amp;&amp; Main.litsC lq_tmp$x##4661 == Set_empty 0
                                                                                                   &amp;&amp; Main.litsF lq_tmp$x##4661 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##4661 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 48: </span>
<span class=hs-linenum> 49: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>getModel</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{f:</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Model</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Model</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 50: </span><span class='hs-definition'>getModel</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Model</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Model</span>
<span class=hs-linenum> 51: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3139:[[GHC.Types.Int]] -&gt; lq_tmp$x##3140:[GHC.Types.Int] -&gt; (GHC.Maybe.Maybe [GHC.Types.Int])</span><span class='hs-definition'>getModel</span></a> <span class='hs-conid'>[]</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-varid'>model</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##3191:a -&gt; {lq_tmp$x##3189 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##3189
                                                                  &amp;&amp; fromJust lq_tmp$x##3189 == lq_tmp$x##3191
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##3189 == lq_tmp$x##3191} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3206 : [GHC.Types.Int] | lq_tmp$x##3206 == model##a1Y7
                                    &amp;&amp; len lq_tmp$x##3206 &gt;= 0}</span><span class='hs-varid'>model</span></a>
<span class=hs-linenum> 52: </span><span class='hs-definition'>getModel</span> <span class='hs-varid'>formula</span> <span class='hs-varid'>model</span>
<span class=hs-linenum> 53: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>any</span></a> <a class=annot href="#"><span class=annottext>forall a##a4a6 .
v:[a##a4a6] -&gt; {lq_tmp$x##3257 : GHC.Types.Bool | (lq_tmp$x##3257 &lt;=&gt; len v == 0)
                                                  &amp;&amp; (not lq_tmp$x##3257 &lt;=&gt; len v &gt; 0)}</span><span class='hs-varid'>null</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3326 : [[GHC.Types.Int]] | lq_tmp$x##3326 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##3326 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##4636 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##4636)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 54: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>any</span></a> <a class=annot href="#"><span class=annottext>xcmp:{lq_tmp$x##3407 : [{lq_tmp$x##3404 : GHC.Types.Int | $k_##3398[VV##3397:=lq_tmp$x##3404][VV##3402:=lq_tmp$x##3407][lq_tmp$db##13:=lq_anf$##7205759403792805755##d3a3][lq_tmp$db##15:=lq_anf$##7205759403792805756##d3a4]}]&lt;\lq_tmp$x##3405 VV -&gt; {lq_tmp$x##3406 : GHC.Types.Int | $k_##3401[VV##3400:=lq_tmp$x##3406][VV##3402:=lq_tmp$x##3407][lq_tmp$db##13:=lq_anf$##7205759403792805755##d3a3][lq_tmp$db##15:=lq_anf$##7205759403792805756##d3a4][lq_tmp$x##3399:=lq_tmp$x##3405]}&gt; | $k_##3403[VV##3402:=lq_tmp$x##3407][lq_tmp$db##13:=lq_anf$##7205759403792805755##d3a3][lq_tmp$db##15:=lq_anf$##7205759403792805756##d3a4]} -&gt; {lq_tmp$x##3396 : GHC.Types.Bool | $k_##3395[VV##3394:=lq_tmp$x##3396][lq_tmp$db##13:=lq_anf$##7205759403792805755##d3a3][lq_tmp$db##15:=lq_anf$##7205759403792805756##d3a4]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; $k_##3409[VV##3408:=lq_tmp$x##3396][lq_tmp$db##13:=lq_anf$##7205759403792805755##d3a3][lq_tmp$db##15:=lq_anf$##7205759403792805756##d3a4][lq_tmp$x##3410:=xcmp]}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>forall a##a4a6 .
v:[a##a4a6] -&gt; {lq_tmp$x##3343 : GHC.Types.Bool | (lq_tmp$x##3343 &lt;=&gt; len v == 0)
                                                  &amp;&amp; (not lq_tmp$x##3343 &lt;=&gt; len v &gt; 0)}</span><span class='hs-varid'>null</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3373:[{lq_tmp$x##3378 : GHC.Types.Int | $k_##3377[VV##3376:=lq_tmp$x##3378][lq_tmp$x##3372:=GHC.Classes.$fEqInt]}] -&gt; [{lq_tmp$x##3378 : GHC.Types.Int | $k_##3377[VV##3376:=lq_tmp$x##3378][lq_tmp$x##3372:=GHC.Classes.$fEqInt]}]</span><span class='hs-varid'>nub</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3503 : [[GHC.Types.Int]] | lq_tmp$x##3503 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##3503 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##4618 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##4618)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 55: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe (GHC.Types.Int, [[GHC.Types.Int]]))</span><span class='hs-varid'>unitPropagate</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3573 : [[GHC.Types.Int]] | lq_tmp$x##3573 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##3573 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 56: </span>    <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>updatedFormula</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3139:[[GHC.Types.Int]] -&gt; lq_tmp$x##3140:[GHC.Types.Int] -&gt; (GHC.Maybe.Maybe [GHC.Types.Int])</span><span class='hs-varid'>getModel</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4603 : [[GHC.Types.Int]] | lq_tmp$x##4603 == updatedFormula##a1Yb
                                      &amp;&amp; len lq_tmp$x##4603 &gt;= 0}</span><span class='hs-varid'>updatedFormula</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4540 : [{lq_tmp$x##4550 : GHC.Types.Int | $k_##4549[VV##4548:=lq_tmp$x##4550][lq_tmp$x##4544:=l##a1Ya][lq_tmp$x##4545:=model##a1Y7]}]&lt;\lq_tmp$x##4547 VV -&gt; {lq_tmp$x##4550 : GHC.Types.Int | $k_##4552[VV##4551:=lq_tmp$x##4550][lq_tmp$x##4544:=l##a1Ya][lq_tmp$x##4545:=model##a1Y7][lq_tmp$x##4553:=lq_tmp$x##4547]}&gt; | Main.litsC lq_tmp$x##4540 == Set_cup (Main.litsC model##a1Y7) (Set_sng l##a1Ya)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; Main.litsF lq_tmp$x##4540 == Set_cup (Main.litsF model##a1Y7) (Main.litsC l##a1Ya)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; head lq_tmp$x##4540 == l##a1Ya
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##4540 == 1 + len model##a1Y7
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; listElts lq_tmp$x##4540 == Set_cup (Set_sng l##a1Ya) (listElts model##a1Y7)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; tail lq_tmp$x##4540 == model##a1Y7}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4555 : GHC.Types.Int | lq_tmp$x##4555 == l##a1Ya}</span><span class='hs-varid'>l</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4559 : [GHC.Types.Int] | lq_tmp$x##4559 == model##a1Y7
                                    &amp;&amp; len lq_tmp$x##4559 &gt;= 0}</span><span class='hs-varid'>model</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 57: </span>    <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe (GHC.Types.Int, [[GHC.Types.Int]]))</span><span class='hs-varid'>pureLiteralAssign</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3705 : [[GHC.Types.Int]] | lq_tmp$x##3705 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##3705 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 58: </span>      <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <span class='hs-varid'>updatedFormula</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3139:[[GHC.Types.Int]] -&gt; lq_tmp$x##3140:[GHC.Types.Int] -&gt; (GHC.Maybe.Maybe [GHC.Types.Int])</span><span class='hs-varid'>getModel</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4394 : [[GHC.Types.Int]] | lq_tmp$x##4394 == updatedFormula##a1Yd
                                      &amp;&amp; len lq_tmp$x##4394 &gt;= 0}</span><span class='hs-varid'>updatedFormula</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4331 : [{lq_tmp$x##4341 : GHC.Types.Int | $k_##4340[VV##4339:=lq_tmp$x##4341][lq_tmp$x##4335:=l##a1Yc][lq_tmp$x##4336:=model##a1Y7]}]&lt;\lq_tmp$x##4338 VV -&gt; {lq_tmp$x##4341 : GHC.Types.Int | $k_##4343[VV##4342:=lq_tmp$x##4341][lq_tmp$x##4335:=l##a1Yc][lq_tmp$x##4336:=model##a1Y7][lq_tmp$x##4344:=lq_tmp$x##4338]}&gt; | Main.litsC lq_tmp$x##4331 == Set_cup (Main.litsC model##a1Y7) (Set_sng l##a1Yc)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; Main.litsF lq_tmp$x##4331 == Set_cup (Main.litsF model##a1Y7) (Main.litsC l##a1Yc)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; head lq_tmp$x##4331 == l##a1Yc
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##4331 == 1 + len model##a1Y7
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; listElts lq_tmp$x##4331 == Set_cup (Set_sng l##a1Yc) (listElts model##a1Y7)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; tail lq_tmp$x##4331 == model##a1Y7}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4346 : GHC.Types.Int | lq_tmp$x##4346 == l##a1Yc}</span><span class='hs-varid'>l</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4350 : [GHC.Types.Int] | lq_tmp$x##4350 == model##a1Y7
                                    &amp;&amp; len lq_tmp$x##4350 &gt;= 0}</span><span class='hs-varid'>model</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 59: </span>      <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe GHC.Types.Int)</span><span class='hs-varid'>chooseLiteral</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3808 : [[GHC.Types.Int]] | lq_tmp$x##3808 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##3808 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 60: </span>        <span class='hs-conid'>Just</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 61: </span>          <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe [GHC.Types.Int])</span><span class='hs-varid'>getModel</span></a> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>propagate</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3885 : GHC.Types.Int | lq_tmp$x##3885 == l##a1Ye}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3895 : [[GHC.Types.Int]] | lq_tmp$x##3895 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##3895 &gt;= 0}</span><span class='hs-varid'>formula</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3908 : [{lq_tmp$x##3918 : GHC.Types.Int | $k_##3917[VV##3916:=lq_tmp$x##3918][lq_tmp$x##3912:=l##a1Ye][lq_tmp$x##3913:=model##a1Y7]}]&lt;\lq_tmp$x##3915 VV -&gt; {lq_tmp$x##3918 : GHC.Types.Int | $k_##3920[VV##3919:=lq_tmp$x##3918][lq_tmp$x##3912:=l##a1Ye][lq_tmp$x##3913:=model##a1Y7][lq_tmp$x##3921:=lq_tmp$x##3915]}&gt; | Main.litsC lq_tmp$x##3908 == Set_cup (Main.litsC model##a1Y7) (Set_sng l##a1Ye)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; Main.litsF lq_tmp$x##3908 == Set_cup (Main.litsF model##a1Y7) (Main.litsC l##a1Ye)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; head lq_tmp$x##3908 == l##a1Ye
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3908 == 1 + len model##a1Y7
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; listElts lq_tmp$x##3908 == Set_cup (Set_sng l##a1Ye) (listElts model##a1Y7)
                                                                                                                                                                                                                                                                                                                                       &amp;&amp; tail lq_tmp$x##3908 == model##a1Y7}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3923 : GHC.Types.Int | lq_tmp$x##3923 == l##a1Ye}</span><span class='hs-varid'>l</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3927 : [GHC.Types.Int] | lq_tmp$x##3927 == model##a1Y7
                                    &amp;&amp; len lq_tmp$x##3927 &gt;= 0}</span><span class='hs-varid'>model</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 62: </span>            <span class='hs-conid'>Just</span> <span class='hs-varid'>resultModel</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##4177:a -&gt; {lq_tmp$x##4175 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##4175
                                                                  &amp;&amp; fromJust lq_tmp$x##4175 == lq_tmp$x##4177
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##4175 == lq_tmp$x##4177} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4192 : [GHC.Types.Int] | lq_tmp$x##4192 == resultModel##a1Yf
                                    &amp;&amp; len lq_tmp$x##4192 &gt;= 0}</span><span class='hs-varid'>resultModel</span></a>
<span class=hs-linenum> 63: </span>            <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3139:[[GHC.Types.Int]] -&gt; lq_tmp$x##3140:[GHC.Types.Int] -&gt; (GHC.Maybe.Maybe [GHC.Types.Int])</span><span class='hs-varid'>getModel</span></a> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>propagate</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4008 : GHC.Types.Int | lq_tmp$x##4008 == (-l##a1Ye)}</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4011 : GHC.Types.Int | lq_tmp$x##4011 == l##a1Ye}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4057 : [[GHC.Types.Int]] | lq_tmp$x##4057 == ds_d32n
                                      &amp;&amp; len lq_tmp$x##4057 &gt;= 0}</span><span class='hs-varid'>formula</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4083 : [{lq_tmp$x##4093 : GHC.Types.Int | $k_##4092[VV##4091:=lq_tmp$x##4093][lq_tmp$x##4087:=lq_anf$##7205759403792805772##d3ak][lq_tmp$x##4088:=model##a1Y7]}]&lt;\lq_tmp$x##4090 VV -&gt; {lq_tmp$x##4093 : GHC.Types.Int | $k_##4095[VV##4094:=lq_tmp$x##4093][lq_tmp$x##4087:=lq_anf$##7205759403792805772##d3ak][lq_tmp$x##4088:=model##a1Y7][lq_tmp$x##4096:=lq_tmp$x##4090]}&gt; | Main.litsC lq_tmp$x##4083 == Set_cup (Main.litsC model##a1Y7) (Set_sng lq_anf$##7205759403792805772##d3ak)
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; Main.litsF lq_tmp$x##4083 == Set_cup (Main.litsF model##a1Y7) (Main.litsC lq_anf$##7205759403792805772##d3ak)
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; head lq_tmp$x##4083 == lq_anf$##7205759403792805772##d3ak
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; len lq_tmp$x##4083 == 1 + len model##a1Y7
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; listElts lq_tmp$x##4083 == Set_cup (Set_sng lq_anf$##7205759403792805772##d3ak) (listElts model##a1Y7)
                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; tail lq_tmp$x##4083 == model##a1Y7}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4070 : GHC.Types.Int | lq_tmp$x##4070 == (-l##a1Ye)}</span><span class='hs-comment'>-</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4073 : GHC.Types.Int | lq_tmp$x##4073 == l##a1Ye}</span><span class='hs-varid'>l</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4102 : [GHC.Types.Int] | lq_tmp$x##4102 == model##a1Y7
                                    &amp;&amp; len lq_tmp$x##4102 &gt;= 0}</span><span class='hs-varid'>model</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 64: </span>        <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##3825 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##3825)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>unitPropagate</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{f:</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Literal</span><span class='hs-layout'>,</span> <span class='hs-conid'>Formula</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 67: </span><span class='hs-definition'>unitPropagate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Literal</span><span class='hs-layout'>,</span> <span class='hs-conid'>Formula</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 68: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2394:[[GHC.Types.Int]] -&gt; (GHC.Maybe.Maybe (GHC.Types.Int, [[GHC.Types.Int]]))</span><span class='hs-definition'>unitPropagate</span></a> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-varid'>formula</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 69: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2479 : [{lq_tmp$x##2498 : [{lq_tmp$x##2495 : GHC.Types.Int | $k_##2489[VV##2488:=lq_tmp$x##2495][VV##2493:=lq_tmp$x##2498][lq_tmp$x##2484:=lq_anf$##7205759403792805742##d39Q][lq_tmp$x##2485:=formula##a1Yg]}]&lt;\lq_tmp$x##2496 VV -&gt; {lq_tmp$x##2497 : GHC.Types.Int | $k_##2492[VV##2491:=lq_tmp$x##2497][VV##2493:=lq_tmp$x##2498][lq_tmp$x##2484:=lq_anf$##7205759403792805742##d39Q][lq_tmp$x##2485:=formula##a1Yg][lq_tmp$x##2490:=lq_tmp$x##2496]}&gt; | $k_##2494[VV##2493:=lq_tmp$x##2498][lq_tmp$x##2484:=lq_anf$##7205759403792805742##d39Q][lq_tmp$x##2485:=formula##a1Yg]}] | len lq_tmp$x##2479 &lt;= len formula##a1Yg}</span><span class='hs-varid'>filter</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2465 : (GHC.Classes.Eq GHC.Types.Int) | lq_tmp$x##2465 == GHC.Classes.$fEqInt}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV##2411 : [{VV##2406 : GHC.Types.Int | $k_##2407}]&lt;\lq_tmp$x##2408 VV -&gt; {VV##2409 : GHC.Types.Int | $k_##2410}&gt; | $k_##2412}</span><span class='hs-varid'>clause</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2421 : GHC.Types.Int | lq_tmp$x##2421 == len clause##a1Yh
                                  &amp;&amp; lq_tmp$x##2421 &gt;= 0}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2439 : [{lq_tmp$x##2436 : GHC.Types.Int | $k_##2407[VV##2406:=lq_tmp$x##2436][VV##2411:=lq_tmp$x##2439]}]&lt;\lq_tmp$x##2440 VV -&gt; {lq_tmp$x##2438 : GHC.Types.Int | $k_##2410[VV##2409:=lq_tmp$x##2438][VV##2411:=lq_tmp$x##2439][lq_tmp$x##2408:=lq_tmp$x##2440][lq_tmp$x##2437:=lq_tmp$x##2440]}&gt; | lq_tmp$x##2439 == clause##a1Yh
                                                                                                                                                                                                                                                                                                               &amp;&amp; len lq_tmp$x##2439 &gt;= 0
                                                                                                                                                                                                                                                                                                               &amp;&amp; $k_##2412[VV##2411:=lq_tmp$x##2439]}</span><span class='hs-varid'>clause</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2445 : GHC.Types.Int | lq_tmp$x##2445 == (lq_anf$##7205759403792805740##d39O : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2517 : [[GHC.Types.Int]] | lq_tmp$x##2517 == formula##a1Yg
                                      &amp;&amp; len lq_tmp$x##2517 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 70: </span>    <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>unitLit</span><span class='hs-keyglyph'>]</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##2941:a -&gt; {lq_tmp$x##2939 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##2939
                                                                  &amp;&amp; fromJust lq_tmp$x##2939 == lq_tmp$x##2941
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##2939 == lq_tmp$x##2941} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2867 : ({lq_tmp$x##2875 : GHC.Types.Int | $k_##2874[VV##2873:=lq_tmp$x##2875][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V]}, {lq_tmp$x##2902 : [{lq_tmp$x##2896 : [{lq_tmp$x##2893 : GHC.Types.Int | $k_##2877[VV##2876:=lq_tmp$x##2893][VV##2881:=lq_tmp$x##2896][VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V]}]&lt;\lq_tmp$x##2894 VV -&gt; {lq_tmp$x##2895 : GHC.Types.Int | $k_##2880[VV##2879:=lq_tmp$x##2895][VV##2881:=lq_tmp$x##2896][VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2878:=lq_tmp$x##2894]}&gt; | $k_##2882[VV##2881:=lq_tmp$x##2896][VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V]}]&lt;\lq_tmp$x##2897 VV -&gt; {lq_tmp$x##2901 : [{lq_tmp$x##2898 : GHC.Types.Int | $k_##2885[VV##2884:=lq_tmp$x##2898][VV##2889:=lq_tmp$x##2901][VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2883:=lq_tmp$x##2897]}]&lt;\lq_tmp$x##2899 VV -&gt; {lq_tmp$x##2900 : GHC.Types.Int | $k_##2888[VV##2887:=lq_tmp$x##2900][VV##2889:=lq_tmp$x##2901][VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2883:=lq_tmp$x##2897][lq_tmp$x##2886:=lq_tmp$x##2899]}&gt; | $k_##2890[VV##2889:=lq_tmp$x##2901][VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2883:=lq_tmp$x##2897]}&gt; | $k_##2892[VV##2891:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V]})&lt;\lq_tmp$x##2872 VV -&gt; {lq_tmp$x##2902 : [{lq_tmp$x##2896 : [{lq_tmp$x##2893 : GHC.Types.Int | $k_##2904[VV##2903:=lq_tmp$x##2893][VV##2906:=lq_tmp$x##2895][VV##2908:=lq_tmp$x##2896][VV##2911:=lq_tmp$x##2898][VV##2914:=lq_tmp$x##2900][VV##2916:=lq_tmp$x##2901][VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}]&lt;\lq_tmp$x##2905 VV -&gt; {VV##2906 : GHC.Types.Int | $k_##2907[VV##2903:=lq_tmp$x##2893][VV##2908:=lq_tmp$x##2896][VV##2911:=lq_tmp$x##2898][VV##2914:=lq_tmp$x##2900][VV##2916:=lq_tmp$x##2901][VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}&gt; | $k_##2909[VV##2903:=lq_tmp$x##2893][VV##2906:=lq_tmp$x##2895][VV##2908:=lq_tmp$x##2896][VV##2911:=lq_tmp$x##2898][VV##2914:=lq_tmp$x##2900][VV##2916:=lq_tmp$x##2901][VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}]&lt;\lq_tmp$x##2897 VV -&gt; {lq_tmp$x##2901 : [{lq_tmp$x##2898 : GHC.Types.Int | $k_##2912[VV##2903:=lq_tmp$x##2893][VV##2906:=lq_tmp$x##2895][VV##2908:=lq_tmp$x##2896][VV##2911:=lq_tmp$x##2898][VV##2914:=lq_tmp$x##2900][VV##2916:=lq_tmp$x##2901][VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}]&lt;\lq_tmp$x##2913 VV -&gt; {VV##2914 : GHC.Types.Int | $k_##2915[VV##2903:=lq_tmp$x##2893][VV##2906:=lq_tmp$x##2895][VV##2908:=lq_tmp$x##2896][VV##2911:=lq_tmp$x##2898][VV##2916:=lq_tmp$x##2901][VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}&gt; | $k_##2917[VV##2903:=lq_tmp$x##2893][VV##2906:=lq_tmp$x##2895][VV##2908:=lq_tmp$x##2896][VV##2911:=lq_tmp$x##2898][VV##2914:=lq_tmp$x##2900][VV##2916:=lq_tmp$x##2901][VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}&gt; | $k_##2919[VV##2918:=lq_tmp$x##2902][lq_tmp$x##2870:=unitLit##a1Yi][lq_tmp$x##2871:=lq_anf$##7205759403792805747##d39V][lq_tmp$x##2920:=lq_tmp$x##2872]}&gt; | fst lq_tmp$x##2867 == unitLit##a1Yi
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; snd lq_tmp$x##2867 == lq_anf$##7205759403792805747##d39V
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; x_Tuple21 lq_tmp$x##2867 == unitLit##a1Yi
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; x_Tuple22 lq_tmp$x##2867 == lq_anf$##7205759403792805747##d39V}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2922 : GHC.Types.Int | lq_tmp$x##2922 == unitLit##a1Yi
                                  &amp;&amp; $k_##2489[VV##2488:=lq_tmp$x##2922][VV##2493:=lq_anf$##7205759403792805745##d39T][liquid_internal_this:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2479:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2484:=lq_anf$##7205759403792805742##d39Q][lq_tmp$x##2485:=formula##a1Yg][lq_tmp$x##2495:=lq_tmp$x##2922][lq_tmp$x##2498:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2522:=lq_tmp$x##2922][lq_tmp$x##2525:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2531:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2624:=lq_tmp$x##2922][lq_tmp$x##2627:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2633:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2668:=lq_tmp$x##2922][lq_tmp$x##2671:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2754:=lq_tmp$x##2922][lq_tmp$x##2757:=lq_anf$##7205759403792805745##d39T]}</span><span class='hs-varid'>unitLit</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-varid'>removeLiteral</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2846 : GHC.Types.Int | lq_tmp$x##2846 == unitLit##a1Yi
                                  &amp;&amp; $k_##2489[VV##2488:=lq_tmp$x##2846][VV##2493:=lq_anf$##7205759403792805745##d39T][liquid_internal_this:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2479:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2484:=lq_anf$##7205759403792805742##d39Q][lq_tmp$x##2485:=formula##a1Yg][lq_tmp$x##2495:=lq_tmp$x##2846][lq_tmp$x##2498:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2522:=lq_tmp$x##2846][lq_tmp$x##2525:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2531:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2624:=lq_tmp$x##2846][lq_tmp$x##2627:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2633:=lq_anf$##7205759403792805744##d39S][lq_tmp$x##2668:=lq_tmp$x##2846][lq_tmp$x##2671:=lq_anf$##7205759403792805745##d39T][lq_tmp$x##2754:=lq_tmp$x##2846][lq_tmp$x##2757:=lq_anf$##7205759403792805745##d39T]}</span><span class='hs-varid'>unitLit</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2856 : [[GHC.Types.Int]] | lq_tmp$x##2856 == formula##a1Yg
                                      &amp;&amp; len lq_tmp$x##2856 &gt;= 0}</span><span class='hs-varid'>formula</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 71: </span>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##3071 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##3071)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>pureLiteralAssign</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{f:</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Literal</span><span class='hs-layout'>,</span> <span class='hs-conid'>Formula</span><span class='hs-layout'>)</span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 74: </span><span class='hs-definition'>pureLiteralAssign</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Literal</span><span class='hs-layout'>,</span> <span class='hs-conid'>Formula</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 75: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1962:[[GHC.Types.Int]] -&gt; (GHC.Maybe.Maybe (GHC.Types.Int, [[GHC.Types.Int]]))</span><span class='hs-definition'>pureLiteralAssign</span></a> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-varid'>formula</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 76: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2032:[{lq_tmp$x##2037 : GHC.Types.Int | $k_##2036[VV##2035:=lq_tmp$x##2037][lq_tmp$x##2031:=GHC.Classes.$fEqInt]}] -&gt; [{lq_tmp$x##2037 : GHC.Types.Int | $k_##2036[VV##2035:=lq_tmp$x##2037][lq_tmp$x##2031:=GHC.Classes.$fEqInt]}]</span><span class='hs-varid'>nub</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[{lq_tmp$x##1998 : GHC.Types.Int | $k_##1997[VV##1996:=lq_tmp$x##1998][lq_tmp$x##1989:=Data.Foldable.$36$fFoldable$91$$93$][lq_tmp$x##1990:=formula##a1Yj]}]</span><span class='hs-varid'>concat</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2013 : [[GHC.Types.Int]] | lq_tmp$x##2013 == formula##a1Yj
                                      &amp;&amp; len lq_tmp$x##2013 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 77: </span>    <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##2069 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##2069)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 78: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>literal</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##2297:a -&gt; {lq_tmp$x##2295 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##2295
                                                                  &amp;&amp; fromJust lq_tmp$x##2295 == lq_tmp$x##2297
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##2295 == lq_tmp$x##2297} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2223 : ({lq_tmp$x##2231 : GHC.Types.Int | $k_##2230[VV##2229:=lq_tmp$x##2231][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L]}, {lq_tmp$x##2258 : [{lq_tmp$x##2252 : [{lq_tmp$x##2249 : GHC.Types.Int | $k_##2233[VV##2232:=lq_tmp$x##2249][VV##2237:=lq_tmp$x##2252][VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L]}]&lt;\lq_tmp$x##2250 VV -&gt; {lq_tmp$x##2251 : GHC.Types.Int | $k_##2236[VV##2235:=lq_tmp$x##2251][VV##2237:=lq_tmp$x##2252][VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2234:=lq_tmp$x##2250]}&gt; | $k_##2238[VV##2237:=lq_tmp$x##2252][VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L]}]&lt;\lq_tmp$x##2253 VV -&gt; {lq_tmp$x##2257 : [{lq_tmp$x##2254 : GHC.Types.Int | $k_##2241[VV##2240:=lq_tmp$x##2254][VV##2245:=lq_tmp$x##2257][VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2239:=lq_tmp$x##2253]}]&lt;\lq_tmp$x##2255 VV -&gt; {lq_tmp$x##2256 : GHC.Types.Int | $k_##2244[VV##2243:=lq_tmp$x##2256][VV##2245:=lq_tmp$x##2257][VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2239:=lq_tmp$x##2253][lq_tmp$x##2242:=lq_tmp$x##2255]}&gt; | $k_##2246[VV##2245:=lq_tmp$x##2257][VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2239:=lq_tmp$x##2253]}&gt; | $k_##2248[VV##2247:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L]})&lt;\lq_tmp$x##2228 VV -&gt; {lq_tmp$x##2258 : [{lq_tmp$x##2252 : [{lq_tmp$x##2249 : GHC.Types.Int | $k_##2260[VV##2259:=lq_tmp$x##2249][VV##2262:=lq_tmp$x##2251][VV##2264:=lq_tmp$x##2252][VV##2267:=lq_tmp$x##2254][VV##2270:=lq_tmp$x##2256][VV##2272:=lq_tmp$x##2257][VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}]&lt;\lq_tmp$x##2261 VV -&gt; {VV##2262 : GHC.Types.Int | $k_##2263[VV##2259:=lq_tmp$x##2249][VV##2264:=lq_tmp$x##2252][VV##2267:=lq_tmp$x##2254][VV##2270:=lq_tmp$x##2256][VV##2272:=lq_tmp$x##2257][VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}&gt; | $k_##2265[VV##2259:=lq_tmp$x##2249][VV##2262:=lq_tmp$x##2251][VV##2264:=lq_tmp$x##2252][VV##2267:=lq_tmp$x##2254][VV##2270:=lq_tmp$x##2256][VV##2272:=lq_tmp$x##2257][VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}]&lt;\lq_tmp$x##2253 VV -&gt; {lq_tmp$x##2257 : [{lq_tmp$x##2254 : GHC.Types.Int | $k_##2268[VV##2259:=lq_tmp$x##2249][VV##2262:=lq_tmp$x##2251][VV##2264:=lq_tmp$x##2252][VV##2267:=lq_tmp$x##2254][VV##2270:=lq_tmp$x##2256][VV##2272:=lq_tmp$x##2257][VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}]&lt;\lq_tmp$x##2269 VV -&gt; {VV##2270 : GHC.Types.Int | $k_##2271[VV##2259:=lq_tmp$x##2249][VV##2262:=lq_tmp$x##2251][VV##2264:=lq_tmp$x##2252][VV##2267:=lq_tmp$x##2254][VV##2272:=lq_tmp$x##2257][VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}&gt; | $k_##2273[VV##2259:=lq_tmp$x##2249][VV##2262:=lq_tmp$x##2251][VV##2264:=lq_tmp$x##2252][VV##2267:=lq_tmp$x##2254][VV##2270:=lq_tmp$x##2256][VV##2272:=lq_tmp$x##2257][VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}&gt; | $k_##2275[VV##2274:=lq_tmp$x##2258][lq_tmp$x##2226:=literal##a1Yk][lq_tmp$x##2227:=lq_anf$##7205759403792805737##d39L][lq_tmp$x##2276:=lq_tmp$x##2228]}&gt; | fst lq_tmp$x##2223 == literal##a1Yk
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; snd lq_tmp$x##2223 == lq_anf$##7205759403792805737##d39L
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; x_Tuple21 lq_tmp$x##2223 == literal##a1Yk
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; x_Tuple22 lq_tmp$x##2223 == lq_anf$##7205759403792805737##d39L}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2278 : GHC.Types.Int | lq_tmp$x##2278 == literal##a1Yk
                                  &amp;&amp; $k_##2036[VV##2035:=lq_tmp$x##2278][liquid_internal_this:=lq_anf$##7205759403792805736##d39K][lq_tmp$x##2027:=lq_anf$##7205759403792805736##d39K][lq_tmp$x##2031:=GHC.Classes.$fEqInt][lq_tmp$x##2032:=lq_anf$##7205759403792805734##d39I][lq_tmp$x##2037:=lq_tmp$x##2278][lq_tmp$x##2046:=lq_tmp$x##2278][lq_tmp$x##2049:=lq_anf$##7205759403792805736##d39K][lq_tmp$x##2132:=lq_tmp$x##2278][lq_tmp$x##2135:=lq_anf$##7205759403792805736##d39K]}</span><span class='hs-varid'>literal</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-varid'>removeLiteralInstances</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2202 : GHC.Types.Int | lq_tmp$x##2202 == literal##a1Yk
                                  &amp;&amp; $k_##2036[VV##2035:=lq_tmp$x##2202][liquid_internal_this:=lq_anf$##7205759403792805736##d39K][lq_tmp$x##2027:=lq_anf$##7205759403792805736##d39K][lq_tmp$x##2031:=GHC.Classes.$fEqInt][lq_tmp$x##2032:=lq_anf$##7205759403792805734##d39I][lq_tmp$x##2037:=lq_tmp$x##2202][lq_tmp$x##2046:=lq_tmp$x##2202][lq_tmp$x##2049:=lq_anf$##7205759403792805736##d39K][lq_tmp$x##2132:=lq_tmp$x##2202][lq_tmp$x##2135:=lq_anf$##7205759403792805736##d39K]}</span><span class='hs-varid'>literal</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2212 : [[GHC.Types.Int]] | lq_tmp$x##2212 == formula##a1Yj
                                      &amp;&amp; len lq_tmp$x##2212 &gt;= 0}</span><span class='hs-varid'>formula</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 79: </span>
<span class=hs-linenum> 80: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>chooseLiteral</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{f:</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Literal</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>chooseLiteral</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Literal</span>
<span class=hs-linenum> 82: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1573:[[GHC.Types.Int]] -&gt; (GHC.Maybe.Maybe GHC.Types.Int)</span><span class='hs-definition'>chooseLiteral</span></a> <a class=annot href="#"><span class=annottext>[[GHC.Types.Int]]</span><span class='hs-varid'>formula</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 83: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>[{lq_tmp$x##1602 : GHC.Types.Int | $k_##1601[VV##1600:=lq_tmp$x##1602][lq_tmp$x##1593:=Data.Foldable.$36$fFoldable$91$$93$][lq_tmp$x##1594:=formula##a1Yl]}]</span><span class='hs-varid'>concat</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1617 : [[GHC.Types.Int]] | lq_tmp$x##1617 == formula##a1Yl
                                      &amp;&amp; len lq_tmp$x##1617 &gt;= 0}</span><span class='hs-varid'>formula</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 84: </span>    <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {lq_tmp$x##1645 : (GHC.Maybe.Maybe a) | not (isJust lq_tmp$x##1645)} | VV == GHC.Maybe.Nothing}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum> 85: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>literal</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1689:a -&gt; {lq_tmp$x##1687 : (GHC.Maybe.Maybe a) | isJust lq_tmp$x##1687
                                                                  &amp;&amp; fromJust lq_tmp$x##1687 == lq_tmp$x##1689
                                                                  &amp;&amp; lqdc##$select##GHC.Maybe.Just##1 lq_tmp$x##1687 == lq_tmp$x##1689} | VV == GHC.Maybe.Just}</span><span class='hs-conid'>Just</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1693 : GHC.Types.Int | lq_tmp$x##1693 == literal##a1Ym
                                  &amp;&amp; $k_##1601[VV##1600:=lq_tmp$x##1693][liquid_internal_this:=lq_anf$##7205759403792805729##d39D][lq_tmp$x##1589:=lq_anf$##7205759403792805729##d39D][lq_tmp$x##1593:=Data.Foldable.$36$fFoldable$91$$93$][lq_tmp$x##1594:=formula##a1Yl][lq_tmp$x##1602:=lq_tmp$x##1693][lq_tmp$x##1622:=lq_tmp$x##1693][lq_tmp$x##1625:=lq_anf$##7205759403792805729##d39D][lq_tmp$x##1649:=lq_tmp$x##1693][lq_tmp$x##1652:=lq_anf$##7205759403792805729##d39D]}</span><span class='hs-varid'>literal</span></a>
<span class=hs-linenum> 86: </span>  <span class='hs-comment'>-- choose Literal :: f : Formula -&gt; Maybe {l: literal | l &lt;- litsF}</span>
<span class=hs-linenum> 87: </span>  <span class='hs-comment'>-- specifies something about the literal that is True for , ex:</span>
<span class=hs-linenum> 88: </span>  <span class='hs-comment'>-- have to return a maybe to consider possiblity of empty list</span>
<span class=hs-linenum> 89: </span>  <span class='hs-comment'>-- to add precondition :</span>
<span class=hs-linenum> 90: </span>  <span class='hs-comment'>-- choose Literal | :: f : {f: Formula | size (litsF f)&gt;0} -&gt; {l : Literal | l &lt;- litsF f}</span>
<span class=hs-linenum> 91: </span>  <span class='hs-comment'>-- add set \= 0</span>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>chooseLiteral'</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{f:</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>| litsF f /= S.empty }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{l :</span> <span class='hs-conid'>Literal</span> <span class='hs-keyword'>| S.member l (litsF f)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 94: </span><span class='hs-definition'>chooseLiteral'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Literal</span>
<span class=hs-linenum> 95: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1019:{VV : [[GHC.Types.Int]] | Main.litsF VV /= Set_empty 0} -&gt; {VV : GHC.Types.Int | Set_mem VV (Main.litsF lq_tmp$x##1019)}</span><span class='hs-definition'>chooseLiteral'</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span> <span class='hs-conop'>:</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1019:{VV : [[GHC.Types.Int]] | Main.litsF VV /= Set_empty 0} -&gt; {VV : GHC.Types.Int | Set_mem VV (Main.litsF lq_tmp$x##1019)}</span><span class='hs-varid'>chooseLiteral'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1186 : [[GHC.Types.Int]] | lq_tmp$x##1186 == cs##a1Yn
                                      &amp;&amp; len lq_tmp$x##1186 &gt;= 0}</span><span class='hs-varid'>cs</span></a>
<span class=hs-linenum> 96: </span><span class='hs-definition'>chooseLiteral'</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1226 : GHC.Types.Int | lq_tmp$x##1226 == l##a1Yo}</span><span class='hs-varid'>l</span></a>
<span class=hs-linenum> 97: </span><span class='hs-definition'>chooseLiteral'</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##1082:{lq_tmp$x##1078 : [GHC.Types.Char] | GHC.Types.False} -&gt; a | VV == Main.die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1069 : [GHC.Types.Char] | len lq_tmp$x##1069 == strLen lq_anf$##7205759403792805715##d39p
                                     &amp;&amp; lq_tmp$x##1069 ~~ lq_anf$##7205759403792805715##d39p}</span><span class='hs-str'>"chooseLiteral': empty list"</span></a>
<span class=hs-linenum> 98: </span>
<span class=hs-linenum> 99: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>propagate</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{l:</span> <span class='hs-conid'>Literal</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>100: </span><span class='hs-definition'>propagate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Literal</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span>
<span class=hs-linenum>101: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1815:GHC.Types.Int -&gt; lq_tmp$x##1816:[[GHC.Types.Int]] -&gt; [[GHC.Types.Int]]</span><span class='hs-definition'>propagate</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>literal</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>removeLiteralInstances</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1832 : GHC.Types.Int | lq_tmp$x##1832 == (-literal##a1Yq)}</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1835 : GHC.Types.Int | lq_tmp$x##1835 == literal##a1Yq}</span><span class='hs-varid'>literal</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>removeLiteral</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{l:</span> <span class='hs-conid'>Literal</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>104: </span><span class='hs-definition'>removeLiteral</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Literal</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span>
<span class=hs-linenum>105: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1877:GHC.Types.Int -&gt; lq_tmp$x##1878:[[GHC.Types.Int]] -&gt; [[GHC.Types.Int]]</span><span class='hs-definition'>removeLiteral</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>literal</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filter</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1902:[{lq_tmp$x##1908 : GHC.Types.Int | $k_##1907[VV##1906:=lq_tmp$x##1908][lq_tmp$x##1899:=Data.Foldable.$36$fFoldable$91$$93$][lq_tmp$x##1900:=GHC.Classes.$fEqInt][lq_tmp$x##1901:=literal##a1Yr]}] -&gt; GHC.Types.Bool</span><span class='hs-layout'>(</span></a><span class='hs-varid'>notElem</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1916 : GHC.Types.Int | lq_tmp$x##1916 == literal##a1Yr}</span><span class='hs-varid'>literal</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- write refinement types</span>
<span class=hs-linenum>108: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>removeLiteralInstances</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>{l:</span> <span class='hs-conid'>Literal</span> <span class='hs-keyword'>| True }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>109: </span><span class='hs-definition'>removeLiteralInstances</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Literal</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Formula</span>
<span class=hs-linenum>110: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1698:GHC.Types.Int -&gt; lq_tmp$x##1699:[[GHC.Types.Int]] -&gt; [[GHC.Types.Int]]</span><span class='hs-definition'>removeLiteralInstances</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>literal</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1745:[{lq_tmp$x##1750 : GHC.Types.Int | $k_##1749[VV##1748:=lq_tmp$x##1750][lq_tmp$x##1744:=lq_anf$##7205759403792805730##d39E]}] -&gt; {lq_tmp$x##1739 : [{lq_tmp$x##1750 : GHC.Types.Int | $k_##1749[VV##1748:=lq_tmp$x##1750][lq_tmp$x##1744:=lq_anf$##7205759403792805730##d39E]}] | len lq_tmp$x##1739 &lt;= len lq_tmp$x##1745}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>filter</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1714 : GHC.Types.Bool | lq_tmp$x##1714 &lt;=&gt; ds_d30Y /= literal##a1Ys}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>/=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1727 : GHC.Types.Int | lq_tmp$x##1727 == literal##a1Ys}</span><span class='hs-varid'>literal</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>die</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ _:</span><span class='hs-conid'>String</span> <span class='hs-keyword'>| False }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>113: </span><span class='hs-definition'>die</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>114: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##751:{VV##0 : [GHC.Types.Char] | GHC.Types.False} -&gt; a</span><span class='hs-definition'>die</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span>
</pre>
</body>
</html>